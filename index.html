<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mosh3L G-Phone</title>
    <style>
        :root { --green: #2ecc71; --red: #e74c3c; --blue: #3498db; --pink: #fd79a8; --brown: #8d6e63; --dark: #121212; }
        body { background: transparent; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; }
        
        /* THE PHONE CONTAINER */
        #g-phone {
            width: 360px; height: 680px; background: var(--dark); border: 4px solid var(--green);
            border-radius: 35px; position: absolute; display: flex; flex-direction: column;
            box-shadow: 0 20px 50px rgba(0,0,0,0.9); transition: border-color 0.5s;
        }

        /* STEALTH CONTROLS (RED/BLUE) */
        .top-bar { background: var(--blue); height: 40px; border-radius: 30px 30px 0 0; cursor: move; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; }
        .controls span { color: white; font-weight: bold; cursor: pointer; margin-left: 10px; }
        .controls .close:hover { color: var(--red); }

        /* LESTER TERMINAL BUTTON (3x3 GREEN GRID) */
        .lester-trigger { width: 30px; height: 30px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; cursor: pointer; border: 2px solid transparent; padding: 2px; }
        .lester-trigger:hover { border-color: var(--green); box-shadow: 0 0 10px var(--green); }
        .dot { background: var(--green); width: 6px; height: 6px; border-radius: 1px; }

        /* APP GRID */
        .content { padding: 20px; flex-grow: 1; text-align: center; }
        .google-facade { font-size: 24px; color: white; margin-bottom: 20px; font-weight: bold; }
        .google-facade span { color: var(--green); } /* Mosh3L Branding */
        
        .shortcut-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .app { cursor: pointer; transition: 0.2s; }
        .app:hover { transform: scale(1.1); }
        .icon { width: 50px; height: 50px; border-radius: 12px; margin: 0 auto 5px; display: flex; align-items: center; justify-content: center; font-size: 20px; }

        /* SHIFU BOX */
        #shifu-chat { background: #1a1a1a; padding: 15px; color: #888; font-style: italic; border-top: 1px solid #333; height: 80px; overflow-y: auto; font-size: 13px; border-radius: 0 0 30px 30px; }
        
        /* ADMIN MODE */
        .admin-active { border-color: var(--brown) !important; }
    </style>
</head>
<body onload="initDraggable()">

<div id="g-phone">
    <div class="top-bar" id="drag-handle">
        <div class="lester-trigger" onclick="toggleTerminal()">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <div class="controls">
            <span onclick="window.minimize()">‚Äî</span>
            <span class="close" onclick="window.close()">X</span>
        </div>
    </div>

    <div class="content">
        <div class="google-facade">Mosh<span>3L</span></div>
        <div class="shortcut-grid">
            <div class="app" onclick="openApp('gmail')"><div class="icon" style="background: var(--pink);">üìß</div></div>
            <div class="app" onclick="openApp('images')"><div class="icon" style="background: var(--pink);">üîç</div></div>
            <div class="app" onclick="openApp('youtube')"><div class="icon" style="background: var(--pink);">üì∫</div></div>
            <div class="app" onclick="runSecurity()"><div class="icon" style="background: var(--blue);">üõ°Ô∏è</div></div>
        </div>
    </div>

    <div id="shifu-chat">"Patience is a weapon, but a functioning script is better. What are we doing, student?"</div>
</div>

<script>
    let isAdmin = false;

    async function shifuSpeak(trigger) {
        const res = await fetch('/shifu', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({context: trigger, admin: isAdmin})
        });
        const data = await res.json();
        document.getElementById('shifu-chat').innerText = `"${data.response}"`;
    }

    function toggleTerminal() {
        if(!isAdmin) {
            let pass = prompt("Admin Credentials Required:");
            if(pass === "1738A") {
                isAdmin = true;
                document.getElementById('g-phone').classList.add('admin-active');
                shifuSpeak('admin_login');
            } else {
                shifuSpeak('fail');
            }
        } else {
            alert("Lester Terminal: Loading Attack/Defense Modules...");
        }
    }

    function initDraggable() {
        const el = document.getElementById("g-phone");
        const handle = document.getElementById("drag-handle");
        let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
        handle.onmousedown = (e) => {
            pos3 = e.clientX; pos4 = e.clientY;
            document.onmouseup = () => { document.onmouseup = null; document.onmousemove = null; };
            document.onmousemove = (e) => {
                pos1 = pos3 - e.clientX; pos2 = pos4 - e.clientY;
                pos3 = e.clientX; pos4 = e.clientY;
                el.style.top = (el.offsetTop - pos2) + "px";
                el.style.left = (el.offsetLeft - pos1) + "px";
            };
        };
    }
</script>
</body>
</html>